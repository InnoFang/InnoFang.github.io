<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="记一次由Java读写速度引发的TLE的一点探索"><meta name="keywords" content="算法"><meta name="author" content="Inno Fang"><meta name="copyright" content="Inno Fang"><title>记一次由Java读写速度引发的TLE的一点探索 | Inno' Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="Inno' Blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8F%90%E4%BA%A4"><span class="toc-number">2.</span> <span class="toc-text">第一次提交</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E6%8F%90%E4%BA%A4"><span class="toc-number">3.</span> <span class="toc-text">第二次提交</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Google-%E4%B8%80%E4%B8%8B"><span class="toc-number">4.</span> <span class="toc-text">Google 一下</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AC%A1%E6%8F%90%E4%BA%A4"><span class="toc-number">5.</span> <span class="toc-text">第三次提交</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8-Quora-%E4%B8%AD%E7%9C%8B%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">6.</span> <span class="toc-text">在 Quora 中看到的问题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8F%90%E9%AB%98%E8%BE%93%E5%87%BA%E9%80%9F%E5%BA%A6%E7%9A%84%E5%BB%BA%E8%AE%AE"><span class="toc-number">7.</span> <span class="toc-text">提高输出速度的建议</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">8.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars0.githubusercontent.com/u/15724026?s=400&amp;u=ee5d1bee0d44d91b01465f82910464fda54b91cc&amp;v=4"></div><div class="author-info__name text-center">Inno Fang</div><div class="author-info__description text-center">Programming is an art form</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/InnoFang">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">64</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">17</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">17</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友链 / links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://wmpscc.github.io/">HeoLis</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://barackbao.com/">Brarack Bao</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://wanghao15536870732.github.io/">HyYyr Wang</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://www.ingernotes.cn/">Inger Chao</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://www.angus-liu.cn/">Angus Liu 's Blog</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://ww1.sinaimg.cn/large/0067fiZ7ly1g1i7dlvohrj31hc0u0aa7.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Inno' Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/gallery">Gallery</a><a class="site-page" href="/about">About</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">记一次由Java读写速度引发的TLE的一点探索</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-03-05</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p><strong>注</strong>：TLE 是 Time Limit Exceeded 的缩写，即时间超限，表示你提交的程序运行使用了超出题目限定的时间</p>
</blockquote>
<p>偶然间做了道水题，<a target="_blank" rel="noopener" href="https://www.patest.cn/contests/gplt/L1-005">题目在此</a>。</p>
<span id="more"></span>

<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><img src="https://cdn.jsdelivr.net/gh/innofang/jotter/source/%E5%AF%B9Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/problem.jpg"> </p>
<p>我的思路很简单，建一个学生对象数组，在读入数据时把数据存入一个对象里，然后再根据_试机座位号码_输出对应数据即可。</p>
<h1 id="第一次提交"><a href="#第一次提交" class="headerlink" title="第一次提交"></a>第一次提交</h1><p>因为我并不是 ACM 选手，刷题纯属兴趣，而我的主要语言是 Java 和 Kotlin，所以我的 Java 代码是这样的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Stu</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> id;</span><br><span class="line">        <span class="keyword">int</span> exam;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Stu</span><span class="params">(<span class="keyword">long</span> id, <span class="keyword">int</span> exam)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = id;</span><br><span class="line">            <span class="keyword">this</span>.exam = exam;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span> + id + <span class="string">&quot; &quot;</span> + exam;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(<span class="keyword">new</span> BufferedInputStream(System.in));</span><br><span class="line">        <span class="keyword">while</span> (in.hasNextInt()) &#123;</span><br><span class="line">            <span class="keyword">int</span> N = in.nextInt();</span><br><span class="line">            Stu[] stus = <span class="keyword">new</span> Stu[N + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">                <span class="keyword">long</span> id = in.nextLong();</span><br><span class="line">                <span class="keyword">int</span> test = in.nextInt();</span><br><span class="line">                <span class="keyword">int</span> exam = in.nextInt();</span><br><span class="line">                stus[test] = <span class="keyword">new</span> Stu(id, exam);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> M = in.nextInt();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i++) &#123;</span><br><span class="line">                System.out.println(stus[in.nextInt()]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>就是读入和输出，基本没什么逻辑可言，但是很不幸</p>
<p><img src="https://cdn.jsdelivr.net/gh/innofang/jotter/source/%E5%AF%B9Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/TLE1.jpg"><br><br /></p>
<p>TLE！？😨这道几乎没什么逻辑的题怎么会超时呢？🤔</p>
<h1 id="第二次提交"><a href="#第二次提交" class="headerlink" title="第二次提交"></a>第二次提交</h1><p>我思考了一会，那问题只能是出在读写上了。我在输入的时候，使用 BufferedInputStream 这个包装了输入流，应该要比直接用 Scanner 输入要快的，那么应该是在输出的时候出了问题，那么我就是用 PrintWriter 来替换原本的输出好了，下面是更改过后的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;    <span class="comment">// IDEA 自动导的包</span></span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;             <span class="comment">// IDEA 自动导的包</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Stu</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> id;</span><br><span class="line">        <span class="keyword">int</span> exam;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Stu</span><span class="params">(<span class="keyword">long</span> id, <span class="keyword">int</span> exam)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = id;</span><br><span class="line">            <span class="keyword">this</span>.exam = exam;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span> + id + <span class="string">&quot; &quot;</span> + exam;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(<span class="keyword">new</span> BufferedInputStream(System.in));</span><br><span class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> BufferedOutputStream(System.out));    <span class="comment">// 使用 PrintWriter，并使用了缓冲流加快输出</span></span><br><span class="line">        <span class="keyword">while</span> (in.hasNextInt()) &#123;</span><br><span class="line">            <span class="keyword">int</span> N = in.nextInt();</span><br><span class="line">            Stu[] stus = <span class="keyword">new</span> Stu[N + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">                <span class="keyword">long</span> id = in.nextLong();</span><br><span class="line">                <span class="keyword">int</span> test = in.nextInt();</span><br><span class="line">                <span class="keyword">int</span> exam = in.nextInt();</span><br><span class="line">                stus[test] = <span class="keyword">new</span> Stu(id, exam);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> M = in.nextInt();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i++) &#123;</span><br><span class="line">                out.println(stus[in.nextInt()]);    <span class="comment">// 输出</span></span><br><span class="line">            &#125;</span><br><span class="line">            out.flush();        <span class="comment">// 将读到的内容从缓冲区输出</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样总该没问题了吧</p>
<p><img src="https://cdn.jsdelivr.net/gh/innofang/jotter/source/%E5%AF%B9Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/TLE2.jpg"><br><br /></p>
<p>WTF！？说实话，当时我都觉得这道题就是来坑 Java 选手的 🙃</p>
<h1 id="Google-一下"><a href="#Google-一下" class="headerlink" title="Google 一下"></a>Google 一下</h1><p>没办法，只能请教 Google 大爷了，Google 搜索 <code>Java in ACM TLE, how to improve input and output speed</code> （原谅我的英语渣😅</p>
<p>首先，我在 GeeksForGeeks 中看到了这个 <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/fast-io-in-java-in-competitive-programming/">Fast I/O in Java in Competitive Programming</a></p>
<p>在文章的开头，作者还吐槽了一下 Java 的读写速度 😂</p>
<p><img src="https://cdn.jsdelivr.net/gh/innofang/jotter/source/%E5%AF%B9Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/gfg.jpg"><br><br /></p>
<p><strong>很感谢文章作者提供的思路和代码</strong>。</p>
<p>作者在文中第二点中提到了使用 BufferedReader 和 StringTokenizer，他是这么解释的</p>
<blockquote>
<p>BufferedReader – (fast, but not recommended as it requires lot of typing): The Java.io.BufferedReader class reads text from a character-input stream, buffering characters so as to provide for the efficient reading of characters, arrays, and lines. With this method we will have to parse the value every time for desired type. Reading multiple words from single line adds to its complexity because of the use of Stringtokenizer and hence this is not recommended. This gets accepted with a running time of approx 0.89 s.but still as you can see it requires a lot of typing all together and therefore method 3 is recommended.</p>
</blockquote>
<p>大致意思就是，BufferedReader 从字符输入流中读取文本，缓冲字符以提供字符、数组和行的有效读取，但是用这种方式读取每次都要解析所需的类型的值，因此使用了 Stringtokenizer 这个类，不过这个方法需要大量输入，所以作者建议使用文章的第三种方法</p>
<p>大家可以去看看第三点，你可以直接看代码，作者定义了一个 FastReader 类，包装了 BufferedReader 和 StringTokenizer，使得起来跟 Scanner 差不多，并且文中作者很推荐这种方法，表示容易记忆并且对大多数遇到的竞赛题目都足够快</p>
<blockquote>
<p>this method is <em>very much recommended</em> as it is easy to remember and is fast enough to meet the needs of most of the question in competitive coding.</p>
</blockquote>
<p>因为作者将这个 FastReader 类包装成了内部类，所以下面就直接展示这个内部类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">FastReader</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       BufferedReader br;</span><br><span class="line">       StringTokenizer st;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="title">FastReader</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span></span><br><span class="line">                    InputStreamReader(System.in));</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function">String <span class="title">next</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">while</span> (st == <span class="keyword">null</span> || !st.hasMoreElements())</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="keyword">try</span></span><br><span class="line">               &#123;</span><br><span class="line">                   st = <span class="keyword">new</span> StringTokenizer(br.readLine());</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">catch</span> (IOException  e)</span><br><span class="line">               &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> st.nextToken();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">int</span> <span class="title">nextInt</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> Integer.parseInt(next());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">long</span> <span class="title">nextLong</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> Long.parseLong(next());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">double</span> <span class="title">nextDouble</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> Double.parseDouble(next());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function">String <span class="title">nextLine</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           String str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">           <span class="keyword">try</span></span><br><span class="line">           &#123;</span><br><span class="line">               str = br.readLine();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">catch</span> (IOException e)</span><br><span class="line">           &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> str;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>虽然作者说很好记，但是，emmmm ……🤨</p>
<p>代码思路不难理解，基本就是把  BufferedReader 和 StringTokenizer 的操作进行了一个包装，理解了思路，敲起来还算顺手，只是为了读入快那么一点，就要写这么多总觉得不划算</p>
<h1 id="第三次提交"><a href="#第三次提交" class="headerlink" title="第三次提交"></a>第三次提交</h1><p>理解了思路过后，最后修改代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Stu</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> id;</span><br><span class="line">        <span class="keyword">int</span> exam;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Stu</span><span class="params">(<span class="keyword">long</span> id, <span class="keyword">int</span> exam)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = id;</span><br><span class="line">            <span class="keyword">this</span>.exam = exam;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span> + id + <span class="string">&quot; &quot;</span> + exam;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        FastReader in = <span class="keyword">new</span> FastReader();</span><br><span class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> BufferedOutputStream(System.out));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> N = in.nextInt();</span><br><span class="line">        Stu[] stus = <span class="keyword">new</span> Stu[N + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">long</span> id = in.nextLong();</span><br><span class="line">            <span class="keyword">int</span> test = in.nextInt();</span><br><span class="line">            <span class="keyword">int</span> exam = in.nextInt();</span><br><span class="line">            stus[test] = <span class="keyword">new</span> Stu(id, exam);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> M = in.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i++) &#123;</span><br><span class="line">            out.println(stus[in.nextInt()]);</span><br><span class="line">        &#125;</span><br><span class="line">        out.flush();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">FastReader</span> </span>&#123;</span><br><span class="line">        BufferedReader br;</span><br><span class="line">        StringTokenizer st;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">FastReader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span></span><br><span class="line">                    InputStreamReader(System.in));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function">String <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (st == <span class="keyword">null</span> || !st.hasMoreElements()) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    st = <span class="keyword">new</span> StringTokenizer(br.readLine());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> st.nextToken();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">nextInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.parseInt(next());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">long</span> <span class="title">nextLong</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Long.parseLong(next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>把不用的方法去掉，再次提交</p>
<p><img src="https://cdn.jsdelivr.net/gh/innofang/jotter/source/%E5%AF%B9Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/AC.jpg"><br><br /></p>
<p>🎉哇，可算通过了，不过就这么个问题 Java 用了这么长的代码，估计 C/C++ 要偷笑了</p>
<p>在上面那篇文章中，作者还提到了第四点，他封装了一个 Reader 类，但是那代码量就更多了，当然速度更快，不过作者也不建议这种方法，大家感兴趣的可以自己去看看</p>
<h1 id="在-Quora-中看到的问题"><a href="#在-Quora-中看到的问题" class="headerlink" title="在 Quora 中看到的问题"></a>在 Quora 中看到的问题</h1><p>此外，我还在 Quora 中还看到了<a target="_blank" rel="noopener" href="https://www.quora.com/How-can-I-make-my-Java-programs-run-efficiently-for-very-large-inputs-for-submission-to-online-judges-like-CodeChef">这个问题</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/innofang/jotter/source/%E5%AF%B9Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/quora.jpg"><br><br /></p>
<p>答主也在回答中对输入做了分点，在后面依然是提到了采用自定义输入类包装 BufferedReader 来提高输入速度。他封装了一个叫 FastScanner 的内部类，不过代码量也不少，这是他的代码文本连接，感兴趣的可以参考一下 <a target="_blank" rel="noopener" href="https://www.codechef.com/viewplaintext/4462437">这个</a> 。</p>
<h1 id="提高输出速度的建议"><a href="#提高输出速度的建议" class="headerlink" title="提高输出速度的建议"></a>提高输出速度的建议</h1><p>在这篇回答的最后，答主还提到了提高输出速度的方法，就是我之前提到的使用 PrintWriter 来代替传统的 System.out.println()，同时要记得在所有输出操作结束时调用 flush() 方法，但是过于频繁的调用也有可能引发 TLE</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>题目本身不难，一般写工程的时候也没有太刻意去提高 I/O 速度，当然我觉的也是我修为不够，还没到那一步，所以在遇到这一道题时，碰到 TLE 的确有点不知所措，我觉得这也算是一个考察点吧，正好了解了如何提高 Java I/O 速度的一点小技巧。</p>
<p>一般情况下，用 <code>Scanner in = new Scanner(new BufferedInputStream(System.in));</code>做输入是足够的，因为写过的题也不少，碰到这种因为输入导致的超时也是第一次，如果某题卡时间真的很紧，那么再考虑用自定义类包装 BufferedReader 的方式，毕竟这种方式虽快，但是代码量也多了不少。</p>
<p>同样的，如果时间卡的不紧的话，用传统的 <code>System.out.println()</code> 我觉得也能应付，当然为了防止输出问题导致超时的话，可以使用 <code>PrintWriter out = new PrintWriter(new BufferedOutputStream(System.out));</code> 的方式，要记得在一轮操作做完后调用 <code>flush()</code> 方法清空缓冲区，不然会输出不了结果。</p>
<p>如果你对我的代码感兴趣，你也可以参考一下 <a target="_blank" rel="noopener" href="https://github.com/InnoFang/Algorithms/blob/master/Java%20Template.md">我的模板</a></p>
<!-- image resource -->

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Inno Fang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://innofang.github.io/2018/03/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%B1Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/">http://innofang.github.io/2018/03/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%B1Java%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6%E5%BC%95%E5%8F%91%E7%9A%84TLE%E7%9A%84%E4%B8%80%E7%82%B9%E6%8E%A2%E7%B4%A2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/03/09/%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E4%BD%A0Github%E4%B8%8A%E7%9A%84%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"><i class="fa fa-chevron-left">  </i><span>如何管理你Github上的开源项目</span></a></div><div class="next-post pull-right"><a href="/2018/02/27/%E9%85%B7!%20kotlin-%E7%9A%84%E4%B8%80%E8%A1%8C%E5%BF%AB%E6%8E%92%E5%AE%9E%E7%8E%B0/"><span>酷! kotlin 的一行快排实现</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(http://ww1.sinaimg.cn/large/0067fiZ7ly1g1i7dlvohrj31hc0u0aa7.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2022 By Inno Fang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Programming is an art form.</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>